
<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ëŒ€ì‚¬ ì—°ìŠµ ë°”ë¡œì‹¤í–‰</title>

<style>
body {
    font-family: -apple-system, BlinkMacSystemFont, sans-serif;
    margin:0;
    padding:15px;
    background:#111;
    color:white;
}
h1 {
    text-align:center;
    font-size:22px;
}
input, textarea {
    width:100%;
    font-size:18px;
    padding:12px;
    margin-top:10px;
    border-radius:12px;
    border:none;
}
textarea {
    height:180px;
}
button {
    width:100%;
    font-size:20px;
    padding:15px;
    margin-top:10px;
    border-radius:15px;
    border:none;
    background:#2a2a2a;
    color:white;
}
.card {
    background:#1e1e1e;
    padding:20px;
    border-radius:20px;
    margin-top:20px;
}
.line {
    font-size:22px;
    margin-top:10px;
    line-height:1.4;
}
.hidden {
    display:none;
}
#startScreen {
    text-align:center;
    margin-top:40px;
}
#app {
    display:none;
}
.bigButton {
    font-size:24px;
    padding:20px;
    background:#444;
}
</style>
</head>
<body>

<div id="startScreen">
    <h1>ğŸ¬ ëŒ€ì‚¬ ì—°ìŠµ</h1>
    <button class="bigButton" onclick="enterApp()">ì—°ìŠµ ì‹œì‘</button>
</div>

<div id="app">

<div>ë‚´ ì—­í• </div>
<input id="myRole" placeholder="ì˜ˆ: ì¡°íŒìˆ˜">

<div>ëŒ€ë³¸ ì…ë ¥ (ì´ë¦„: ëŒ€ì‚¬)</div>
<textarea id="scriptText" placeholder="ì´ê°•í¬: ì™œ ì „í™” ì•ˆ ë°›ì•„?
ì¡°íŒìˆ˜: ì£„ì†¡í•©ë‹ˆë‹¤ í˜•ë‹˜
ì´ê°•í¬: ì–´ë””ì•¼?
ì¡°íŒìˆ˜: ë°–ì…ë‹ˆë‹¤"></textarea>

<button onclick="loadScript()">ëŒ€ë³¸ ë¶ˆëŸ¬ì˜¤ê¸°</button>
<button onclick="startPractice()">ì—°ìŠµ ì‹œì‘</button>
<button onclick="prevLine()">â—€ ì´ì „</button>
<button onclick="nextLine()">ë‹¤ìŒ â–¶</button>
<button onclick="showMyLine()">ë‚´ ëŒ€ì‚¬ ë³´ê¸°</button>

<div class="card">
    <div id="partner" class="line">ì—°ìŠµ ì‹œì‘ì„ ëˆ„ë¥´ì„¸ìš”</div>
    <div id="mine" class="line hidden"></div>
</div>

</div>

<script>
let script = [];
let index = 0;
let myRole = "";

function enterApp(){
    document.getElementById("startScreen").style.display="none";
    document.getElementById("app").style.display="block";
}

function loadScript() {
    const text = document.getElementById("scriptText").value;
    const lines = text.split("\n");
    script = [];

    lines.forEach(line => {
        let match = line.match(/^(.+?):\s*(.+)$/);
        if(match) {
            script.push({
                role: match[1].trim(),
                text: match[2].trim()
            });
        }
    });

    alert("ëŒ€ë³¸ ì¤€ë¹„ ì™„ë£Œ");
}

function startPractice() {
    myRole = document.getElementById("myRole").value.trim();
    if(!myRole) {
        alert("ë‚´ ì—­í•  ì…ë ¥í•˜ì„¸ìš”");
        return;
    }

    index = 0;
    nextLine();
}

function nextLine() {
    while(index < script.length) {
        let line = script[index];
        index++;

        if(line.role !== myRole) {
            showPartner(line);
            return;
        }
    }
    document.getElementById("partner").innerText = "ë";
}

function prevLine() {
    index -= 2;
    if(index < 0) index = 0;
    nextLine();
}

function showPartner(line) {
    document.getElementById("partner").innerText =
        line.role + ": " + line.text;

    document.getElementById("mine").classList.add("hidden");

    speak(line.text);
}

function showMyLine() {
    for(let i=index; i<script.length; i++) {
        if(script[i].role === myRole) {
            let el = document.getElementById("mine");
            el.innerText = myRole + ": " + script[i].text;
            el.classList.remove("hidden");
            return;
        }
    }
}

function speak(text) {
    speechSynthesis.cancel();
    let utter = new SpeechSynthesisUtterance(text);
    utter.lang = "ko-KR";
    utter.rate = 0.95;
    speechSynthesis.speak(utter);
}
</script>

</body>
</html>
