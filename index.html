<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>대본연습</title>

<style>

body{
    margin:0;
    background:#6B8CFF;
    font-family: sans-serif;
    text-align:center;
}

.container{
    max-width:700px;
    margin:auto;
    padding:10px;
}

.banner{
    width:100%;
    border-radius:10px;
    margin-bottom:10px;
}

.script{
    background:white;
    padding:20px;
    border-radius:10px;
    font-size:22px;
    min-height:100px;
}

button{
    font-size:20px;
    padding:15px;
    margin-top:10px;
    width:100%;
    border:none;
    border-radius:10px;
    background:#FFD93D;
}

textarea{
    width:100%;
    height:120px;
    font-size:16px;
    margin-top:10px;
}

</style>

</head>

<body>

<div class="container">

<img src="banner.png" class="banner">

<textarea id="scriptInput">종대: 니 왔나
대번: 왔다
종대: 늦었다
대번: 미안하다</textarea>

<div class="script" id="output">
연습 시작을 누르세요
</div>

<button onclick="startPractice()">연습 시작</button>
<button onclick="nextLine()">다음</button>
<button onclick="prevLine()">이전</button>

</div>

<script>

let lines = [];
let index = -1;

function parseScript(){
    let text = document.getElementById("scriptInput").value;
    lines = text.split("\n");
}

function speak(text){

    speechSynthesis.cancel();

    const utter = new SpeechSynthesisUtterance(text);

    utter.lang = "ko-KR";
    utter.rate = 0.95;
    utter.pitch = 1.05;

    const voices = speechSynthesis.getVoices();

    let bestVoice = voices.find(v =>
        v.lang.includes("ko")
    );

    if(bestVoice){
        utter.voice = bestVoice;
    }

    speechSynthesis.speak(utter);
}

function startPractice(){
    parseScript();
    index = -1;
    nextLine();
}

function nextLine(){

    index++;

    if(index >= lines.length) return;

    let line = lines[index];

    document.getElementById("output").innerText = line;

    speak(line);
}

function prevLine(){

    index--;

    if(index < 0) index = 0;

    let line = lines[index];

    document.getElementById("output").innerText = line;

    speak(line);
}

</script>

</body>
</html>
